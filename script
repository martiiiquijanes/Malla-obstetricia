document.querySelectorAll('.course').forEach(c => {
  c.addEventListener('click', () => {
    const name = c.dataset.name;
    const credits = c.dataset.credits;
    const area = c.dataset.area;
    const prereq = c.dataset.prereq;
    document.getElementById('pName').textContent = name;
    document.getElementById('pCredits').textContent = credits;
    document.getElementById('pArea').textContent = area;
    document.getElementById('pPrereq').textContent = prereq || 'Ninguno';
    document.getElementById('popup').style.display = 'block';
    c.classList.toggle('approved');
    updateAvailability();
  });
});

document.getElementById('closePopup').addEventListener('click', () => {
  document.getElementById('popup').style.display = 'none';
});

function updateAvailability() {
  document.querySelectorAll('.course').forEach(c => c.classList.remove('available'));
  document.querySelectorAll('.course.approved').forEach(ap => {
    const next = findFollowing(ap);
    next.forEach(nc => nc.classList.add('available'));
  });
}

function findFollowing(el) {
  const name = el.dataset.name;
  // Si el curso es "Anatomía", habilita "Embriología" por ej.
  const map = {
    'Anatomía': ['Embriología'],
    'Química General y Orgánica': ['Bioquímica'],
    // Completa esto con tus prerrequisitos reales
  };
  const nexts = map[name] || [];
  return Array.from(document.querySelectorAll('.course'))
    .filter(c => nexts.includes(c.dataset.name));
}
